{% extends 'pages/base.html' %}

{% block title %}{{ event.title }} - Barizi{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto py-10">
    <!-- Event Image -->
    {% if event.image %}
        <img src="{{ event.image.url }}" alt="{{ event.title }}" class="w-full h-80 object-cover rounded-3xl">
    {% else %}
        <div class="w-full h-80 bg-gray-900 rounded-3xl flex items-center justify-center text-white text-2xl font-bold">
            {{ event.title }}
        </div>
    {% endif %}

    <!-- Event Title & Details -->
    <h2 class="text-4xl font-bold mt-6 text-gray-900">{{ event.title }}</h2>
    <p class="text-gray-600 mt-2">{{ event.description }}</p>
    <p class="text-gray-500 mt-1">
        üìÖ {{ event.date }}
        {% if event.time %} | üïí {{ event.time }}{% endif %}
    </p>
    <p class="text-gray-500 mt-1">üè∑Ô∏è Category: {{ event.get_category_display|default:event.category }}</p>
    <p class="text-gray-500 mt-1">üìç {{ event.venue|default:event.city }}</p>

    <!-- Join / Ticket Link -->
    {% if event.join_url %}
        <div class="mt-6 text-center">
            <a href="{{ event.join_url }}" target="_blank">
                <button class="bg-primary text-white py-3 px-8 rounded-lg hover:bg-orange-600 transition">
                    Join / Get Tickets
                </button>
            </a>
        </div>
    {% endif %}

    <!-- Share -->
    <div class="mt-8 flex justify-between items-center">
        <!-- Share Icons -->
        <div class="flex space-x-4">
            <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" title="Share on Facebook">
                <img src="/static/icons/facebook.svg" class="w-6 h-6" alt="Facebook">
            </a>
            <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}" target="_blank" title="Share on Twitter">
                <img src="/static/icons/twitter.svg" class="w-6 h-6" alt="Twitter">
            </a>
            <a href="https://api.whatsapp.com/send?text={{ request.build_absolute_uri }}" target="_blank" title="Share on WhatsApp">
                <img src="/static/icons/whatsapp.svg" class="w-6 h-6" alt="WhatsApp">
            </a>
        </div>

        <!-- Add to Calendar (uses venue/city) -->
        {% if event.time %}
            <a href="https://calendar.google.com/calendar/render?action=TEMPLATE&text={{ event.title }}&details={{ event.description }}&location={{ event.venue|default:event.city }}&dates={{ event.date|date:'Ymd' }}T{{ event.time|time:'His' }}/{{ event.date|date:'Ymd' }}T{{ event.time|time:'His' }}" target="_blank">
                <button class="bg-gray-900 text-white py-2 px-4 rounded-lg hover:bg-black transition">Add to Calendar</button>
            </a>
        {% endif %}
    </div>

    {% if event.has_exhibitors and exhibitor_spaces %}
        <div class="mt-10 border-t pt-8">
            <h3 class="text-2xl font-semibold mb-4">Exhibitor Opportunities</h3>
            <p class="text-gray-600 mb-4">Book a tent, booth, or stall at this event.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {% for space in exhibitor_spaces %}
                    <div class="border rounded-2xl p-5 flex flex-col justify-between">
                        <div>
                            <h4 class="text-lg font-bold">{{ space.name }}</h4>
                            <p class="mt-1 text-gray-600 text-sm">{{ space.description }}</p>
                            <p class="mt-3 font-semibold">Price: TZS {{ space.price }}</p>
                            <p class="mt-1 text-sm text-gray-500">Available slots: {{ space.available_slots }}</p>
                        </div>
                        <div class="mt-4">
                            {% if space.available_slots > 0 %}
                                <a href="{% url 'exhibitor-book-space' space.id %}">
                                    <button class="w-full bg-primary text-white py-2 px-4 rounded-lg hover:bg-orange-600 transition">Book Space</button>
                                </a>
                            {% else %}
                                <button class="w-full bg-gray-300 text-gray-600 py-2 px-4 rounded-lg cursor-not-allowed">Fully Booked</button>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
