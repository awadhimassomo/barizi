{% extends 'pages/base.html' %}
{% load humanize %}

{% block title %}Tour Operator Marketplace - Barizi{% endblock %}

{% block header_image %}/static/images/tours-bg.jpg{% endblock %}

{% block header_title %}Tour Operator Marketplace{% endblock %}

{% block header_subtitle %}Explore top-rated tours and adventures across Tanzania.{% endblock %}

{% block content %}
<div class="container mx-auto p-6">
    <!-- Search Bar -->
    <div class="mb-6">
        <input type="text" placeholder="Search for tours..."
            class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400">
    </div>

    <div class="flex flex-col lg:flex-row gap-6">
        <!-- Filters Sidebar -->
        <aside class="w-full lg:w-1/4 bg-white p-5 rounded-lg shadow">
            <h2 class="text-2xl font-semibold mb-4">Filters</h2>

            <!-- Budget Filter -->
            <div class="mb-5">
                <label class="block text-gray-700 font-medium mb-2">Budget (Tsh)</label>
                <input type="range" id="budgetRange" min="0" max="10000000" value="5000000" class="w-full" oninput="updateBudgetValue(this.value)">
                <div id="budgetValue" class="range-value">Tsh 5,000,000</div>
            </div>

            <!-- Date Filter -->
            <div class="mb-5">
                <label class="block text-gray-700 font-medium mb-2">Travel Dates</label>
                <input type="date" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
            </div>

            <!-- Rating Filter -->
            <div class="mb-5">
                <label class="block text-gray-700 font-medium mb-2">Customer Rating</label>
                <input type="range" min="1" max="5" class="w-full">
            </div>

            <!-- Destination Filter -->
            <div class="mb-5">
                <label class="block text-gray-700 font-medium mb-2">Destination</label>
                <input type="text" placeholder="Enter destination"
                    class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
            </div>

            <!-- Duration Filter -->
            <div class="mb-5">
                <label class="block text-gray-700 font-medium mb-2">Duration (days)</label>
                <input type="number" min="1"
                    class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
            </div>

            <!-- Apply Filters Button -->
            <button class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">Apply Filters</button>
        </aside>

        <!-- Main Content -->
        <main class="w-full lg:w-3/4">
            <h1 class="text-3xl font-bold mb-6">Tour Packages</h1>

            <!-- Tour tours Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for tour in tours %}
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <img src="{{ tour.image.url }}" alt="{{ tour.title }}" class="w-full h-48 object-cover">

                    <div class="p-4">
                        <h3 class="text-xl font-semibold">{{ tour.title }}</h3>
                        <p class="text-sm text-gray-500">By: {{ tour.company_name}}</p>
                        <p class="text-yellow-500">{{ tour.rating }} ‚≠ê ({{ tour.reviews }} Reviews)</p>
                        <p class="text-gray-600 mt-2">{{ tour.description }}</p>
                        <ul class="text-sm text-gray-600 mt-2">
                            <li><strong>Duration:</strong> {{ tour.duration }}</li>
                            <li><strong>Includes:</strong> {{ tour.includes }}</li>
                            <li><strong>Excludes:</strong> {{ tour.excludes }}</li>
                            <li><strong>Cancellation Policy:</strong> {{ tour.cancellation_policy }}</li>
                            <li><strong>Special Offer:</strong> {{ tour.special_offer }}</li>
                        </ul>
                        <p class="text-green-600 font-bold mt-2">Tsh {{ tour.price|intcomma }}</p>
                        <a href="/tour/{{ tour.id }}" class="inline-block mt-3 text-blue-600 hover:underline">View Details</a>
                    </div>
                </div>
                {% empty %}
                <p class="text-center text-gray-600">No tour tours available at the moment.</p>
                {% endfor %}
            </div>
        </main>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function updateBudgetValue(value) {
        document.getElementById('budgetValue').textContent = 'Tsh ' + Number(value).toLocaleString();
    }
</script>
{% endblock %}
