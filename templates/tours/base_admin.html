<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}AI Training Pipeline{% endblock %} - Barizi Admin</title>
    <link rel="stylesheet" href="{% static 'css/dist/styles.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body class="bg-gray-100 text-gray-900">
    <!-- Fixed Sidebar -->
    <aside class="fixed top-0 left-0 w-64 h-screen bg-black p-5 shadow-xl flex flex-col justify-between text-white z-50 overflow-y-auto">
        <div>
            <!-- Logo/Brand -->
            <div class="flex items-center gap-3 mb-8 pb-6 border-b border-white/10">
                <div class="w-10 h-10 rounded-lg bg-primary flex items-center justify-center">
                    <i class="fas fa-brain text-white"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg">AI Training</h1>
                    <p class="text-xs text-gray-400">Admin Panel</p>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="space-y-2">
                <a href="{% url 'ai_training_dashboard' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg {% if request.path == '/ai-training/' %}bg-primary text-white{% else %}text-gray-300 hover:bg-white/10 hover:text-white{% endif %} transition-colors">
                    <i class="fas fa-chart-pie w-5"></i>
                    <span>Dashboard</span>
                </a>
                
                <a href="{% url 'scraping_sources' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg {% if 'sources' in request.path %}bg-primary text-white{% else %}text-gray-300 hover:bg-white/10 hover:text-white{% endif %} transition-colors">
                    <i class="fas fa-spider w-5"></i>
                    <span>Web Scraping</span>
                </a>
                
                <a href="{% url 'raw_itineraries_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg {% if 'raw' in request.path %}bg-primary text-white{% else %}text-gray-300 hover:bg-white/10 hover:text-white{% endif %} transition-colors">
                    <i class="fas fa-file-alt w-5"></i>
                    <span>Raw Data</span>
                </a>
                
                <a href="{% url 'review_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg {% if 'review' in request.path %}bg-primary text-white{% else %}text-gray-300 hover:bg-white/10 hover:text-white{% endif %} transition-colors">
                    <i class="fas fa-check-double w-5"></i>
                    <span>Human Review</span>
                </a>
            </nav>

            <!-- Divider -->
            <div class="my-6 border-t border-white/10"></div>

            <!-- Quick Actions -->
            <div class="space-y-2">
                <p class="text-xs text-gray-500 uppercase tracking-wider px-3 mb-3">Quick Actions</p>
                
                <form method="POST" action="{% url 'run_scraper' %}">
                    {% csrf_token %}
                    <input type="hidden" name="max_items" value="10">
                    <button type="submit" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-green-600/20 hover:text-green-400 transition-colors text-left">
                        <i class="fas fa-play w-5 text-green-500"></i>
                        <span>Run Scraper</span>
                    </button>
                </form>
                
                <form method="POST" action="{% url 'run_gpt_processor' %}">
                    {% csrf_token %}
                    <input type="hidden" name="max_items" value="5">
                    <button type="submit" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-purple-600/20 hover:text-purple-400 transition-colors text-left">
                        <i class="fas fa-robot w-5 text-purple-500"></i>
                        <span>Process with GPT</span>
                    </button>
                </form>
                
                <form method="POST" action="{% url 'export_training_data' %}">
                    {% csrf_token %}
                    <button type="submit" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-blue-600/20 hover:text-blue-400 transition-colors text-left">
                        <i class="fas fa-download w-5 text-blue-500"></i>
                        <span>Export JSONL</span>
                    </button>
                </form>
                
                <form method="POST" action="{% url 'export_sterilized_data' %}" class="w-full">
                    {% csrf_token %}
                    <button type="submit" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-secondary/20 hover:text-secondary transition-colors text-left">
                        <i class="fas fa-code w-5 text-secondary"></i>
                        <span>SERIALIZE</span>
                    </button>
                </form>
            </div>
        </div>

        <!-- Footer -->
        <div class="space-y-3">
            <div class="border-t border-white/10 pt-4">
                <a href="{% url 'dashboard' %}" class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white transition-colors">
                    <i class="fas fa-arrow-left w-5"></i>
                    <span>Back to App</span>
                </a>
                <a href="/admin/" class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white transition-colors">
                    <i class="fas fa-cogs w-5"></i>
                    <span>Django Admin</span>
                </a>
            </div>
            
            <!-- User Info -->
            <div class="flex items-center gap-3 px-3 py-2 bg-white/5 rounded-lg">
                <div class="w-8 h-8 rounded-full bg-primary/30 flex items-center justify-center">
                    <span class="text-sm font-bold text-primary">{{ user.name|slice:":1"|upper }}</span>
                </div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium truncate">{{ user.name }}</p>
                    <p class="text-xs text-gray-500">Admin</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content - Offset by sidebar width -->
    <main class="min-h-screen" style="margin-left: 256px;">
        <!-- Top Bar -->
        <header class="bg-white border-b border-gray-200 px-8 py-4 sticky top-0 z-40">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-xl font-bold text-gray-900">{% block page_title %}AI Training Pipeline{% endblock %}</h1>
                    <p class="text-sm text-gray-500">{% block page_subtitle %}Collect, process, and review itinerary data for model training{% endblock %}</p>
                </div>
                <div class="flex items-center gap-4">
                    {% block header_actions %}{% endblock %}
                </div>
            </div>
        </header>

        <!-- Messages -->
        {% if messages %}
        <div class="px-8 pt-4">
            {% for message in messages %}
            <div class="mb-3 p-4 rounded-lg {% if message.tags == 'success' %}bg-green-50 text-green-700 border border-green-200{% elif message.tags == 'error' %}bg-red-50 text-red-700 border border-red-200{% elif message.tags == 'warning' %}bg-yellow-50 text-yellow-700 border border-yellow-200{% else %}bg-blue-50 text-blue-700 border border-blue-200{% endif %}">
                <div class="flex items-center gap-2">
                    <i class="fas {% if message.tags == 'success' %}fa-check-circle{% elif message.tags == 'error' %}fa-exclamation-circle{% elif message.tags == 'warning' %}fa-exclamation-triangle{% else %}fa-info-circle{% endif %}"></i>
                    {{ message }}
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Page Content -->
        <div class="p-8">
            {% block content %}{% endblock %}
        </div>
    </main>

    {% block extra_js %}{% endblock %}
</body>
</html>
