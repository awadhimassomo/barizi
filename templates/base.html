<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barizi Dashboard</title>

    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="{% static 'css/dist/styles.css' %}">
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body class="bg-gray-200 text-gray-900">
    {% if request.path != "/auth/login/" and request.path != "/auth/registerView/" %}
    <!-- Sidebar -->
    <div class="w-72 bg-sidebarBg p-6 shadow-lg fixed h-full flex flex-col justify-between text-sidebarText">
        <div>
            <!-- Profile Section -->
            <div class="flex flex-col items-center mb-2">
                {% if user.profile_image %}
                <img src="{{ user.profile_image.url }}" alt="{{ user.name }}" class="w-16 h-16 rounded-full border-2 border-gray-500 object-cover">
                {% else %}
                <div class="w-16 h-16 rounded-full border-2 border-gray-500 bg-primary/20 flex items-center justify-center">
                    <span class="text-xl font-bold text-primary">{{ user.name|slice:":1"|upper }}</span>
                </div>
                {% endif %}
                <span class="mt-1 text-lg font-semibold text-center">{{ user.name }}</span>
                <div class="mt-1">
                    <a href="{% url 'profile' %}" class="text-sm text-sidebarText hover:text-sidebarHover">View Profile</a>
                </div>
            </div>

            <!-- Event Planner Links in Separate Div -->
            {% if user.role == 'planner' or user.role == 'admin' %}
            <div class="mt-12">
                <ul class="space-y-4 text-left">
                    <li>
                        <a href="{% url 'event-dashboard' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                            <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-calendar text-sm"></i></span>
                            <span>Event Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'create-event' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                            <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-plus text-sm"></i></span>
                            <span>Create Event</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'my-events' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                            <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-list text-sm"></i></span>
                            <span>My Events</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'exhibitors_overview' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                            <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-store text-sm"></i></span>
                            <span>Exhibitors</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'attendee-list' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                            <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-users text-sm"></i></span>
                            <span>Attendees</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'my-events' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                            <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-handshake text-sm"></i></span>
                            <span>Match Services</span>
                        </a>
                    </li>
                </ul>
            </div>
            {% endif %}

            <ul class="space-y-5 mt-8">
                <!-- Operator Specific Links -->
                {% if user.role == 'operator' or user.role == 'admin' %}
                <li>
                    <a href="{% url 'dashboard' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-chart-bar text-sm"></i></span>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'tour-list' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-box text-sm"></i></span>
                        <span>Packages</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'uploaded_packages_list' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-file-upload text-sm"></i></span>
                        <span>My Packages</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'tour_request_list' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-magic text-sm"></i></span>
                        <span>AI Itineraries</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'vendorlist' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-hotel text-sm"></i></span>
                        <span>Costing</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'operator_booking_list' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-calendar-alt text-sm"></i></span>
                        <span>Bookings</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'vendorlist' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-hotel text-sm"></i></span>
                        <span>Vendors</span>
                    </a>
                </li>
                {% endif %}

                <!-- Admin Only Link -->
                {% if user.role == 'admin' or user.is_staff or user.is_superuser %}
                <li>
                    <a href="{% url 'ai_training_dashboard' %}" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-brain text-sm"></i></span>
                        <span>AI Training</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/" class="flex items-center space-x-3 hover:text-sidebarHover px-2 py-2 rounded-md transition-colors group">
                        <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-cogs text-sm"></i></span>
                        <span>Django Admin</span>
                    </a>
                </li>
                {% endif %}
            </ul>
        </div>

        <!-- Sidebar Footer with Settings and Logout at Bottom -->
        <div class="space-y-4">
            <a href="{% url 'settings' %}" class="flex items-center space-x-3 hover:text-sidebarHover w-full text-left group">
                <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-cog text-sm"></i></span>
                <span>Settings</span>
            </a>
            <button id="toggleDarkMode" class="flex items-center space-x-3 hover:text-sidebarHover w-full text-left group">
                <span class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-primary transition-colors"><i class="fas fa-moon text-sm"></i></span>
                <span>Night Mode</span>
            </button>
            <a href="{% url 'logout' %}" class="flex items-center space-x-3 text-red-400 hover:text-red-600 w-full text-left group">
                <span class="w-8 h-8 rounded-full bg-red-500/20 flex items-center justify-center group-hover:bg-red-500 group-hover:text-white transition-colors"><i class="fas fa-sign-out-alt text-sm"></i></span>
                <span>Logout</span>
            </a>
        </div>
    </div>
    {% endif %}

    <!-- Toast Notifications Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 flex flex-col gap-3 max-w-sm">
        {% if messages %}
        {% for message in messages %}
        <div class="toast-notification transform translate-x-full opacity-0 transition-all duration-300 ease-out"
             data-type="{{ message.tags }}">
            <div class="flex items-start gap-3 p-4 rounded-lg shadow-lg border backdrop-blur-sm
                {% if message.tags == 'success' or 'success' in message.tags %}
                    bg-green-50 border-green-200 text-green-800
                {% elif message.tags == 'error' or 'error' in message.tags %}
                    bg-red-50 border-red-200 text-red-800
                {% elif message.tags == 'warning' or 'warning' in message.tags %}
                    bg-yellow-50 border-yellow-200 text-yellow-800
                {% else %}
                    bg-blue-50 border-blue-200 text-blue-800
                {% endif %}">
                <div class="flex-shrink-0 mt-0.5">
                    {% if message.tags == 'success' or 'success' in message.tags %}
                        <i class="fas fa-check-circle text-green-500"></i>
                    {% elif message.tags == 'error' or 'error' in message.tags %}
                        <i class="fas fa-exclamation-circle text-red-500"></i>
                    {% elif message.tags == 'warning' or 'warning' in message.tags %}
                        <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                    {% else %}
                        <i class="fas fa-info-circle text-blue-500"></i>
                    {% endif %}
                </div>
                <div class="flex-1 text-sm font-medium">{{ message }}</div>
                <button type="button" class="toast-close flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors" aria-label="Close">
                    <i class="fas fa-times text-xs"></i>
                </button>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>

    <!-- Main Content -->
    <div class="{% if request.path != '/auth/login/' and request.path != '/auth/registerView/' %}ml-72{% endif %} p-12 transition-all">
        {% block content %}{% endblock %}
    </div>

    <!-- JavaScript for Dark Mode and Toast Notifications -->
    <script>
        // Dark Mode Toggle
        document.getElementById('toggleDarkMode')?.addEventListener('click', function() {
            document.body.classList.toggle('bg-gray-900');
            document.body.classList.toggle('text-white');
        });

        // Toast Notifications
        document.addEventListener('DOMContentLoaded', function() {
            const toasts = document.querySelectorAll('.toast-notification');
            
            toasts.forEach((toast, index) => {
                // Stagger the appearance of toasts
                setTimeout(() => {
                    toast.classList.remove('translate-x-full', 'opacity-0');
                    toast.classList.add('translate-x-0', 'opacity-100');
                }, index * 100);

                // Auto-dismiss after 5 seconds
                setTimeout(() => {
                    dismissToast(toast);
                }, 5000 + (index * 100));

                // Close button handler
                const closeBtn = toast.querySelector('.toast-close');
                closeBtn?.addEventListener('click', () => dismissToast(toast));
            });

            function dismissToast(toast) {
                toast.classList.add('translate-x-full', 'opacity-0');
                setTimeout(() => toast.remove(), 300);
            }
        });
    </script>
</body>
</html>
